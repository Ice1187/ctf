import gmpy2
from pwn import *
import binascii
from Crypto.PublicKey import RSA

key1 = RSA.importKey(open("./key1", "r"))
key2 = RSA.importKey(open("./key2", "r"))
key3 = RSA.importKey(open("./key3", "r"))

e = 0x10001
n1 = key1.n
n2 = key2.n
n3 = key3.n
c = 0xbbd25f164afd7759043c46d5b6dd0c74fa799a8b87d9d3d10f8f24394f21684a1ad731799495bcf2e7aa185f37864dc8e5b1abae512d26e31ed32deb9f02ceb11cfd63924dbe4092635780aeb311a5ca7250bc7f6c03a6cea7a4cab5821093a386978dfec3f6f3ced9412458b2233c6f4da96713493fdbc415b3937942e2c618d0495a8f5ef3a108aec132224097620e218e3b11717cc18b5bce06fbc7ad75c22116e3dc63942beb66ee06542c949323d67e1d3e5bb7ba46c003686d67186701bc835edfdb39b68ad8c24de698b4e344e764ea4b255440f7e8e662b4542a51c056d4ff6dbe881dab66ca7957c7d3495f2cfdc005dd1edc47cc5b5db980e4e175

p3 = 241088129865542462703136082190012541381172073535792355080244869423083846370211145939974154946617671225419771046987601373089027049123961147255053190008522712608656969179998985956325056584850332566218573931422529313026397450531374018127948127665694836908989993069911903827005730015150089127819305875615807110759
q3 = p3
phi3 = (p3-1) * (q3-1)
d3 = gmpy2.invert(e, phi3)
c = pow(c, d3, n3)

p_add_q = (n2-n1-4) // 2
phi1 = n1 - p_add_q + 1
phi2 = n1 + p_add_q + 1
d1 = gmpy2.invert(e, phi1)
d2 = gmpy2.invert(e, phi2)
c = pow(c, d2, n2)
m = str(hex(int(pow(c, d1, n1)))).strip()[2:]

print m
print len(m)

print binascii.unhexlify(m)



